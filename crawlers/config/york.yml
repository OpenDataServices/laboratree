name: york
description: City of York planning applications (idox)
stealthy: True
pipeline:
  init:
    method: padocs:seed_url_csv
    params:
      file: york.csv
    handle:
      pass: seed
  seed:
    method: padocs.idox:docs_url
    handle:
      pass: fetch
  fetch:
    method: fetch
    handle:
      pass: parse
  parse:
    method: padocs.idox:parse
    handle:
      pass: fetch_doc
  fetch_doc:
    method: fetch
    handle:
      pass: store_doc
  store_doc:
    method: aleph_emit_document
    handle:
      pass: process
  process:
    method: padocs:aleph_process
    handle:
      pass: store
  store:
    method: db
    params:
      table: york_documents
      unique:
        - aleph_document_id
aggregator:
  method: padocs:export
  params:
    table: york_documents